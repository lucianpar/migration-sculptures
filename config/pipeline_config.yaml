# Migration Sculptures Pipeline Configuration

# Data Sources
data_sources:
  movebank:
    # Blue and Fin Whale Satellite Tracks - Irvine et al. 2019
    doi: "10.5441/001/1.47h576f2"
    base_url: "https://www.movebank.org/cms/webapp"
    study_id: 1241071646  # Movebank study ID for the whale dataset
    
  obis_seamap:
    base_url: "https://seamap.env.duke.edu/api"
    gray_whale_dataset: "1899b433-f6e2-40e4-827c-94d6f59785d3"

# Geographic Bounds - Santa Barbara Channel Region
region:
  name: "Santa Barbara Channel"
  # Bounding box for filtering tracks
  bounds:
    min_lat: 33.5
    max_lat: 35.0
    min_lon: -121.0
    max_lon: -119.0
  # Extended bounds for track entry/exit
  extended_bounds:
    min_lat: 32.5
    max_lat: 36.0
    min_lon: -122.5
    max_lon: -117.5
  # UTM Zone for projection (Zone 10N covers Southern California)
  utm_zone: 10
  utm_hemisphere: "N"
  epsg_code: 32610

# Species Configuration
species:
  blue_whale:
    scientific_name: "Balaenoptera musculus"
    tier: 1
    seasons:
      spring:
        start_month: 3
        start_day: 1
        end_month: 5
        end_day: 31
        description: "Northbound feeding migration"
      fall:
        start_month: 10
        start_day: 1
        end_month: 12
        end_day: 31
        description: "Southbound breeding migration"
    min_tracks_per_specimen: 15
    
  fin_whale:
    scientific_name: "Balaenoptera physalus"
    tier: 1
    seasons:
      spring:
        start_month: 3
        start_day: 1
        end_month: 5
        end_day: 31
      fall:
        start_month: 10
        start_day: 1
        end_month: 12
        end_day: 31
    min_tracks_per_specimen: 15
    
  gray_whale:
    scientific_name: "Eschrichtius robustus"
    tier: 2
    seasons:
      spring:
        start_month: 2
        start_day: 15
        end_month: 5
        end_day: 15
        description: "Northbound to Arctic"
      fall:
        start_month: 11
        start_day: 1
        end_month: 1
        end_day: 31
        description: "Southbound to Baja"
    min_tracks_per_specimen: 15
    
  humpback_whale:
    scientific_name: "Megaptera novaeangliae"
    tier: 2
    seasons:
      spring:
        start_month: 3
        start_day: 1
        end_month: 6
        end_day: 30
      fall:
        start_month: 9
        start_day: 1
        end_month: 12
        end_day: 31
    min_tracks_per_specimen: 15

# Processing Parameters
processing:
  # Track Resampling
  resampling:
    temporal_interval_hours: 1  # Resample to hourly points
    spatial_interval_km: 5      # Alternative: fixed spatial intervals
    method: "catmull_rom"       # Spline interpolation method
    
  # Outlier Removal
  outlier_removal:
    max_speed_kmh: 30           # Maximum realistic whale speed
    deviation_threshold_std: 2  # Remove tracks > 2 std from mean path
    
  # Trajectory Bundling
  bundling:
    k_neighbors: 5              # Number of neighbors for attraction
    attraction_strength: 0.3    # How strongly tracks are pulled together
    iterations: 10              # Number of bundling iterations
    decay_rate: 0.9             # Reduce step size each iteration

# Geometry Generation
geometry:
  # Voxel Grid for Isosurface
  voxel_grid:
    resolution: 256             # Grid size (256Â³)
    padding: 0.1                # Padding around data bounds (fraction)
    
  # Isosurface Extraction
  isosurface:
    density_threshold: 0.3      # Marching cubes threshold (0-1)
    smoothing_iterations: 2     # Laplacian smoothing passes
    
  # Mesh Simplification
  mesh:
    max_triangles: 100000       # Target triangle count
    preserve_topology: true
    
  # Output Scaling
  scaling:
    normalize: true             # Normalize to standard bounding box
    normalized_size: 2.0        # Max dimension in meters (scene units)

# Export Settings
export:
  format: "glb"                 # Binary glTF format
  include_metrics: true         # Embed metrics in glTF extras
  
# Initial Target Specimens (10 sculptures)
initial_specimens:
  - species: blue_whale
    season: spring
    years: [2010, 2012, 2014, 2016, 2018]
  - species: blue_whale
    season: fall
    years: [2010, 2012, 2014, 2016, 2018]
